{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/koba/work/huge-reversi/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import React,{useState,useRef,useEffect,useMemo}from'react';import styled from'styled-components';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VirtualContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 600px;\\n  height: 600px;\\n  overflow: auto;\\n  border: 3px solid #4CAF50;\\n  border-radius: 10px;\\n  background-color: #2a2a2a;\\n\"])));const VirtualBoard=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: relative;\\n  width: \",\"px;\\n  height: \",\"px;\\n\"])),props=>props.totalWidth,props=>props.totalHeight);const VirtualRow=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: \",\"px;\\n  width: 100%;\\n  height: \",\"px;\\n  display: flex;\\n\"])),props=>props.top,props=>props.height);const Cell=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  width: 20px;\\n  height: 20px;\\n  background-color: #2e7d32;\\n  border: 1px solid #1b5e20;\\n  cursor: \",\";\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  position: relative;\\n  flex-shrink: 0;\\n  \\n  &:hover {\\n    background-color: \",\";\\n  }\\n\"])),props=>props.clickable?'pointer':'default',props=>props.clickable?'#388e3c':'#2e7d32');const Piece=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  width: 16px;\\n  height: 16px;\\n  border-radius: 50%;\\n  background-color: \",\";\\n  border: 1px solid \",\";\\n\"])),props=>props.player===1?'#000000':'#ffffff',props=>props.player===1?'#333333':'#cccccc');const CELL_SIZE=20;const BUFFER_SIZE=5;function VirtualizedBoard(_ref){let{gameState,onMakeMove,validMoves}=_ref;const containerRef=useRef(null);const[scrollTop,setScrollTop]=useState(0);const[scrollLeft,setScrollLeft]=useState(0);const[containerHeight,setContainerHeight]=useState(600);const[containerWidth,setContainerWidth]=useState(600);useEffect(()=>{const container=containerRef.current;if(!container)return;const handleScroll=()=>{setScrollTop(container.scrollTop);setScrollLeft(container.scrollLeft);};const handleResize=()=>{setContainerHeight(container.clientHeight);setContainerWidth(container.clientWidth);};container.addEventListener('scroll',handleScroll);window.addEventListener('resize',handleResize);handleResize();return()=>{container.removeEventListener('scroll',handleScroll);window.removeEventListener('resize',handleResize);};},[]);const visibleRange=useMemo(()=>{if(!gameState)return{startRow:0,endRow:0,startCol:0,endCol:0};const startRow=Math.max(0,Math.floor(scrollTop/CELL_SIZE)-BUFFER_SIZE);const endRow=Math.min(gameState.boardSize-1,Math.ceil((scrollTop+containerHeight)/CELL_SIZE)+BUFFER_SIZE);const startCol=Math.max(0,Math.floor(scrollLeft/CELL_SIZE)-BUFFER_SIZE);const endCol=Math.min(gameState.boardSize-1,Math.ceil((scrollLeft+containerWidth)/CELL_SIZE)+BUFFER_SIZE);return{startRow,endRow,startCol,endCol};},[scrollTop,scrollLeft,containerHeight,containerWidth,gameState]);const handleCellClick=(row,col)=>{if(validMoves.has(\"\".concat(row,\"-\").concat(col))){onMakeMove(row,col);}};if(!gameState)return null;const totalWidth=gameState.boardSize*CELL_SIZE;const totalHeight=gameState.boardSize*CELL_SIZE;const visibleRows=[];for(let row=visibleRange.startRow;row<=visibleRange.endRow;row++){const cells=[];for(let col=visibleRange.startCol;col<=visibleRange.endCol;col++){const cell=gameState.board[row][col];const isValidMove=validMoves.has(\"\".concat(row,\"-\").concat(col));cells.push(/*#__PURE__*/_jsxs(Cell,{clickable:isValidMove,onClick:()=>handleCellClick(row,col),children:[cell!==0&&/*#__PURE__*/_jsx(Piece,{player:cell}),isValidMove&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',width:'6px',height:'6px',borderRadius:'50%',backgroundColor:'#FFD700',opacity:0.8}})]},\"\".concat(row,\"-\").concat(col)));}visibleRows.push(/*#__PURE__*/_jsx(VirtualRow,{top:row*CELL_SIZE,height:CELL_SIZE,children:/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:visibleRange.startCol*CELL_SIZE},children:cells})},row));}return/*#__PURE__*/_jsx(VirtualContainer,{ref:containerRef,children:/*#__PURE__*/_jsx(VirtualBoard,{totalWidth:totalWidth,totalHeight:totalHeight,children:visibleRows})});}export default VirtualizedBoard;","map":{"version":3,"names":["React","useState","useRef","useEffect","useMemo","styled","jsx","_jsx","jsxs","_jsxs","VirtualContainer","div","_templateObject","_taggedTemplateLiteral","VirtualBoard","_templateObject2","props","totalWidth","totalHeight","VirtualRow","_templateObject3","top","height","Cell","_templateObject4","clickable","Piece","_templateObject5","player","CELL_SIZE","BUFFER_SIZE","VirtualizedBoard","_ref","gameState","onMakeMove","validMoves","containerRef","scrollTop","setScrollTop","scrollLeft","setScrollLeft","containerHeight","setContainerHeight","containerWidth","setContainerWidth","container","current","handleScroll","handleResize","clientHeight","clientWidth","addEventListener","window","removeEventListener","visibleRange","startRow","endRow","startCol","endCol","Math","max","floor","min","boardSize","ceil","handleCellClick","row","col","has","concat","visibleRows","cells","cell","board","isValidMove","push","onClick","children","style","position","width","borderRadius","backgroundColor","opacity","marginLeft","ref"],"sources":["/Users/koba/work/huge-reversi/client/src/components/VirtualizedBoard.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport styled from 'styled-components';\n\nconst VirtualContainer = styled.div`\n  position: relative;\n  width: 600px;\n  height: 600px;\n  overflow: auto;\n  border: 3px solid #4CAF50;\n  border-radius: 10px;\n  background-color: #2a2a2a;\n`;\n\nconst VirtualBoard = styled.div`\n  position: relative;\n  width: ${props => props.totalWidth}px;\n  height: ${props => props.totalHeight}px;\n`;\n\nconst VirtualRow = styled.div`\n  position: absolute;\n  left: 0;\n  top: ${props => props.top}px;\n  width: 100%;\n  height: ${props => props.height}px;\n  display: flex;\n`;\n\nconst Cell = styled.div`\n  width: 20px;\n  height: 20px;\n  background-color: #2e7d32;\n  border: 1px solid #1b5e20;\n  cursor: ${props => props.clickable ? 'pointer' : 'default'};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  flex-shrink: 0;\n  \n  &:hover {\n    background-color: ${props => props.clickable ? '#388e3c' : '#2e7d32'};\n  }\n`;\n\nconst Piece = styled.div`\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  background-color: ${props => props.player === 1 ? '#000000' : '#ffffff'};\n  border: 1px solid ${props => props.player === 1 ? '#333333' : '#cccccc'};\n`;\n\nconst CELL_SIZE = 20;\nconst BUFFER_SIZE = 5;\n\nfunction VirtualizedBoard({ gameState, onMakeMove, validMoves }) {\n  const containerRef = useRef(null);\n  const [scrollTop, setScrollTop] = useState(0);\n  const [scrollLeft, setScrollLeft] = useState(0);\n  const [containerHeight, setContainerHeight] = useState(600);\n  const [containerWidth, setContainerWidth] = useState(600);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleScroll = () => {\n      setScrollTop(container.scrollTop);\n      setScrollLeft(container.scrollLeft);\n    };\n\n    const handleResize = () => {\n      setContainerHeight(container.clientHeight);\n      setContainerWidth(container.clientWidth);\n    };\n\n    container.addEventListener('scroll', handleScroll);\n    window.addEventListener('resize', handleResize);\n    handleResize();\n\n    return () => {\n      container.removeEventListener('scroll', handleScroll);\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  const visibleRange = useMemo(() => {\n    if (!gameState) return { startRow: 0, endRow: 0, startCol: 0, endCol: 0 };\n\n    const startRow = Math.max(0, Math.floor(scrollTop / CELL_SIZE) - BUFFER_SIZE);\n    const endRow = Math.min(\n      gameState.boardSize - 1,\n      Math.ceil((scrollTop + containerHeight) / CELL_SIZE) + BUFFER_SIZE\n    );\n    const startCol = Math.max(0, Math.floor(scrollLeft / CELL_SIZE) - BUFFER_SIZE);\n    const endCol = Math.min(\n      gameState.boardSize - 1,\n      Math.ceil((scrollLeft + containerWidth) / CELL_SIZE) + BUFFER_SIZE\n    );\n\n    return { startRow, endRow, startCol, endCol };\n  }, [scrollTop, scrollLeft, containerHeight, containerWidth, gameState]);\n\n  const handleCellClick = (row, col) => {\n    if (validMoves.has(`${row}-${col}`)) {\n      onMakeMove(row, col);\n    }\n  };\n\n  if (!gameState) return null;\n\n  const totalWidth = gameState.boardSize * CELL_SIZE;\n  const totalHeight = gameState.boardSize * CELL_SIZE;\n\n  const visibleRows = [];\n  for (let row = visibleRange.startRow; row <= visibleRange.endRow; row++) {\n    const cells = [];\n    for (let col = visibleRange.startCol; col <= visibleRange.endCol; col++) {\n      const cell = gameState.board[row][col];\n      const isValidMove = validMoves.has(`${row}-${col}`);\n      \n      cells.push(\n        <Cell\n          key={`${row}-${col}`}\n          clickable={isValidMove}\n          onClick={() => handleCellClick(row, col)}\n        >\n          {cell !== 0 && <Piece player={cell} />}\n          {isValidMove && (\n            <div style={{\n              position: 'absolute',\n              width: '6px',\n              height: '6px',\n              borderRadius: '50%',\n              backgroundColor: '#FFD700',\n              opacity: 0.8\n            }} />\n          )}\n        </Cell>\n      );\n    }\n\n    visibleRows.push(\n      <VirtualRow\n        key={row}\n        top={row * CELL_SIZE}\n        height={CELL_SIZE}\n      >\n        <div style={{ marginLeft: visibleRange.startCol * CELL_SIZE }}>\n          {cells}\n        </div>\n      </VirtualRow>\n    );\n  }\n\n  return (\n    <VirtualContainer ref={containerRef}>\n      <VirtualBoard totalWidth={totalWidth} totalHeight={totalHeight}>\n        {visibleRows}\n      </VirtualBoard>\n    </VirtualContainer>\n  );\n}\n\nexport default VirtualizedBoard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}